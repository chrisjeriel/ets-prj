<style>
    thead tr th {
        position: relative;
    }
    span.ui-column-resizer {
        display: block;
        position: absolute;
        top: 0;
        right: 0;
        margin: 0;
        width: 8px;
        height: 100%;
        padding: 0;
        cursor: col-resize;
    }
</style>


<app-modal class="d-none" (modalOpened)="openModal()" id="lovMdl">
    <div header>List of Values</div>
    <div body *ngIf="modalOpen" style="position: relative;width: 800px;">
        <div class="row"  *ngIf="loadingFlag">
            <img src="app/resources/images/Loading_icon2.gif" alt="loading.gif" id="loading" class="m-auto" style="margin-bottom: 9px!important">
        </div>
        <div id="cust-table-container" [style.display]="!loadingFlag? 'block':'none'">
            <div class="w-100 text-right">
                <div >
                    <label style="margin-right: 3px;">Search: &nbsp;
                        <input type="search" class="form-control-sm cust-search-form" [(ngModel)]="searchString" (keydown.enter)="search()">
                    </label>

                    <div ngbDropdown #drop="ngbDropdown">
                        <button class="cust-filter" ngbDropdownToggle><a><fa name="filter"></fa></a></button>
                        <div ngbDropdownMenu aria-labelledby="dropdownConfig">
                            <div class="dropdown-item">
                                <div class="container" style="padding-left: 5px; padding-right: 5px;">
                                    <div class="row">
                                        <div class="col-sm-12">
                                             <span class="cust-tbl-label">Filter by:</span>
                                        </div>
                                    </div>
                                    <div class="row" style="overflow: auto;">
                                        <div class="col-sm-12" >
                                            <div class="input-group" *ngFor="let filt of passData.filters;let i= index" [ngSwitch]="passData.filters[i].dataType">
                                                <div class="input-group-prepend" style="margin-right: 2px !important" *ngIf="passData.filters[i].dataType != 'expire'">
                                                    <div class="input-group-text cust-ig-text">
                                                        <input type="checkbox" [(ngModel)]="filt.enabled"><span>&nbsp;{{filt.title}}</span>
                                                    </div>
                                                </div>

                                                <input [readonly]="!filt.enabled" [ngModel]="filt.search" (ngModelChange)="filt.search=$event.toUpperCase()" *ngSwitchCase="'text'"  type="text" class="form-control form-control-sm" (keyup.enter)="pressEnterFilter();">
                                                 <input [readonly]="!filt.enabled" [ngModel]="filt.search" (ngModelChange)="filt.search=$event.toUpperCase()" *ngSwitchCase="'expire'"  type="hidden" class="form-control form-control-sm" (keyup.enter)="pressEnterFilter();">
                                                <input [readonly]="!filt.enabled" [ngModel]="filt.search" (ngModelChange)="filt.search=$event.toUpperCase()" *ngSwitchCase="'seq'"  type="text" class="form-control form-control-sm" (keyup.enter)="pressEnterFilter();">

                                                <div class="dp-cont col-sm" style="margin-left: 0 !important;" *ngSwitchCase="'date'">
                                                    <datepicker [type]="'date'" [disabled]="!filt.enabled" [value]="filt.search" (valueChange)="filt.search=$event;"></datepicker>
                                                </div>

                                                <ng-container *ngSwitchCase="'datespan'">

                                                             <div tabindex="0" class="dp-cont col-sm" style="margin-left: 0 !important;" ngbTooltip="From Date" placement="bottom" (keyup.enter)="pressEnterFilter();">
                                                                 <datepicker [type]="'date'" [disabled]="!filt.enabled" [value]="filt.keys?.search" (valueChange)="filt.keys.search=$event; filt.keys.search2 = valChanged('ds', filt.keys.search, filt.keys?.search2)"></datepicker> <!-- filt.keys.search2=$event; -->
                                                             </div>
                                                             <span style="line-height: 1;">&ndash;</span>
                                                             <div tabindex="0" class="dp-cont col-sm" style="margin-left: 0 !important;" ngbTooltip="To Date" placement="bottom" (keyup.enter)="pressEnterFilter();">
                                                                 <datepicker [type]="'date'" [disabled]="!filt.enabled" [value]="filt.keys?.search2" (valueChange)="filt.keys.search2=$event" [minDate]="filt.keys?.search"></datepicker>
                                                             </div>
                                                </ng-container>
                                                 <ng-container *ngSwitchCase="'textspan'">
                                                             <input [readonly]="!filt.enabled" [ngModel]="filt.keys?.search" (ngModelChange)="filt.keys.search=$event.toUpperCase()"  type="text" class="form-control form-control-sm" (keyup.enter)="pressEnterFilter() ;" placement="bottom" ngbTooltip="Min Value" onkeypress='return  event.charCode >= 48 && event.charCode <= 57' appCurrency (change)="filt.keys.search2 = valChanged('ts', filt.keys.search, filt.keys?.search2)">                
                                                        <span style="line-height: 1;">&ndash;</span>
                                                             <input [readonly]="!filt.enabled" [ngModel]="filt.keys?.search2" (ngModelChange)="filt.keys.search2=$event.toUpperCase()" type="text" class="form-control form-controlntrol-sm" (keyup.enter)="pressEnterFilter();" placement="bottom" ngbTooltip="Max Value"  onkeypress='return  event.charCode == 46 || event.charCode >= 48 && event.charCode <= 57' appCurrency (change)="filt.keys.search2 = valChanged('ts', filt.keys.search, filt.keys?.search2)">
                                                </ng-container>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="input-group">
                                                <button #okFilter id="okFilter" class="cust-filter cust-tbl-submit" (click)="addFiller();updatePage(1); drop.close();"><a>Ok</a></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            

            <div class="row"  *ngIf="loadingTableFlag" style="margin-bottom: -148px;padding-top: 74px;">
                <img src="app/resources/images/Loading_icon2.gif" alt="loading.gif" id="loading" class="m-auto" style="margin-bottom: 9px!important">
            </div>

            <div [class.loading]="loadingTableFlag"> <!-- Div of table -->
                <div [id]="'special-lov'+passData.pageID">
                    <div class="table-scroll table-scroll-unli" id="cust-scroll">
                        <table id="non-datatable" class="content-container keypress-class margin-table">
                            <thead >
                                <tr>
                                    <th *ngFor="let tHeader of passData.tHeader; let i = index" [ngSwitch]="passData.dataTypes[i]" [ngStyle]="{'width': (passData.colSize[i] == '' || passData.colSize.length == 0) ? 'auto' : passData.colSize[i]}" [ngbTooltip]="passData.tooltip !== undefined ? passData.tooltip[i] :null">
                                        <!-- <i class="fa fa-map-pin" (click)="pinColumn($event,i)"></i> -->
                                        <span class="ui-column-resizer" (mousedown) = "onMouseDown($event)"></span>
                                        <span *ngSwitchDefault class="gridHeader" (click)="sort(passData.dbKeys[i],sortBy);sortIndex=i;">{{tHeader}}</span>
                                         <i *ngIf="sortBy && i==sortIndex" class="fa fa-caret-down"></i>
                                         <i *ngIf="!sortBy && i==sortIndex" class="fa fa-caret-up"></i>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let data of passData.tableData | paginate: { id: 'non-editable'+passData.pageID, itemsPerPage: passData.pageLength, currentPage: p }; let a = index;" (click)="onRowClick($event, data, a);" (dblclick)="onRowDblClick($event, data)" [class.selected]="data === indvSelect || selected.includes(data) || data?.checked" (keydown.ArrowUp)="tablePress($event, data, a)" (keydown.ArrowDown)="tablePress($event, data, a)" tabindex="0" style="outline: none" id="tableRow" (keydown.Enter)="enterKey($event, data)">
                                    <td *ngFor="let key of passData.keys; let i = index" [ngSwitch]="passData.dataTypes[i]" [ngStyle]="{'max-width': (passData.colSize[i] == '' || passData.colSize.length == 0) ? 'auto' : passData.colSize[i]}">
                                        <div *ngIf="!(data===fillData)">
                                            <div  *ngSwitchCase="passData.dataTypes[i] !== undefined && passData.dataTypes[i].split('-')[0] === 'sequence' ? passData.dataTypes[i] : ''" style="text-align: right">
                                            <span class="unclickable">{{data[key] | number: passData.dataTypes[i].split('-')[1]+'.0' | sequence}}</span>
                                            </div>
                                            <span *ngSwitchDefault class="unclickable">{{ data[key] }}</span>

                                        </div>
                                        <div *ngIf="data===fillData" class="filler">
                                            <span></span>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="pagingStatus">
                    <pagination-template #paw="paginationApi" [id]="'non-editable'+passData.pageID" (pageChange)="p = $event">
                        <label *ngIf="!paw.isLastPage() && count > 0">Showing {{ (paw.getCurrent() - 1) * passData.pageLength + 1 }} - {{ paw.getCurrent() * passData.pageLength }} of {{count}} entries </label>
                        <label *ngIf="paw.isLastPage() && count > 0">Showing {{ (paw.getCurrent() - 1) * passData.pageLength + 1 }} - {{count}} of {{count}} entries</label>
                        <label *ngIf="count < 1">Showing 0 - 0 of 0 entries</label>
                    </pagination-template>
                </div>
                <div class="pagination" >
                    <pagination-controls [id]="'non-editable'+passData.pageID" class="my-pagination" (pageChange)="p = $event;updatePage()" previousLabel="" nextLabel="" >
                    </pagination-controls>
                </div>
                <div style="height: 42px;float: right;">
                </div>
            </div>
        </div>
    </div>
    <div footer>
        <div class="d-flex justify-content-center">
            <button class="cust-btn" type="button" (click)="modal.closeModal();modalOpen=false;"><a>Cancel</a></button>
            <!-- <button [disabled]="indvSelect == ''" class="cust-btn" type="button" (click)="modal.closeModal();modalOpen=false;okBtnClick($event);"><a>Ok</a></button> TRBT#PROD_GRADE -->
            <button [disabled]="indvSelect == ''" class="cust-btn" type="button" (click)="modal.closeModal();modalOpen=false;okBtnClick();"><a>Ok</a></button>
        </div>
    </div>
</app-modal>

