<form #myForm="ngForm">
<div class="container-fluid" style="padding-left: 0px; padding-right: 0px;">
   <div class="row">
      <div class="col-sm-12">
          <fieldset class="scheduler-border">
              <legend class="scheduler-border">Payment Request Info</legend>
                 <div class="container-fluid" style="padding-left: 0px;">
                     <div class="form-row custom-row-inline-inset" style="margin-top: -2px !important;">
                      <div class="input-group" style="margin-bottom: -14px !important; margin-top: 10px !important">
                          <label class="form-control-sm col-sm-1">Request No.</label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <input name="input1" type="text" class="form-control form-control-sm cust-sm col-sm-3" style="margin-right: 3px !important;" [(ngModel)]="saveAcsePaytReq.reqPrefix" readonly>
                            <input name="input2" type="text" class="form-control form-control-sm cust-sm col-sm-3" style="margin-right: 3px !important; text-align: right;" [(ngModel)]="saveAcsePaytReq.reqYear" readonly>
                            <input name="input3" type="text" class="form-control form-control-sm cust-sm col-sm-2" style="margin-right: 3px !important; text-align: right" [(ngModel)]="saveAcsePaytReq.reqMm" readonly>
                            <input name="input4" type="text" class="form-control form-control-sm cust-sm col-sm-4" style="text-align: right" [(ngModel)]="saveAcsePaytReq.reqSeqNo" readonly>
                          </div>
                          <label class="form-control-sm col-sm-1">Payment Type</label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <select name="select1" class="form-control form-control-sm cust-sm col-sm-12 warn" [disabled]="saveAcsePaytReq.reqStatus == 'X' || saveAcsePaytReq.reqSeqNo != ''" appRequired [ngModel]="saveAcsePaytReq.tranTypeCd" (ngModelChange)="saveAcsePaytReq.tranTypeCd=$event;setDefPar();">
                              <option *ngFor="let i of tranTypeList" value="{{ i.tranTypeCd }}">{{ i.tranTypeName }}</option>
                            </select>
                          </div>
                          <label class="form-control-sm col-sm-1">Status</label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <input name="input5" type="text" class="form-control form-control-sm cust-sm col-sm-12" [(ngModel)]="saveAcsePaytReq.reqStatusDesc" readonly>
                          </div>
                      </div>

                      <!-- <div class="input-group" style="margin-bottom: -14px !important;">
                         <label class="form-control-sm col-sm-1" style="height: auto;">Payee</label>
                         <div class="p-0 col-sm-7" style="position: relative;">
                            <input name="input6" type="text" class="form-control form-control-sm cust-sm col-sm-12 warn payee" maxlength="250" [(ngModel)]="saveAcsePaytReq.payee" maxlength="500" appRequired [disabled]="(saveAcsePaytReq.tranTypeCd != 3 && saveAcsePaytReq.tranTypeCd != 4) && existsInReqDtl">
                            <div *ngIf="(!removeIcon && !existsInReqDtl) || ((saveAcsePaytReq.reqStatus == 'N' || saveAcsePaytReq.reqStatus == 'F') && (saveAcsePaytReq.tranTypeCd == 3 || saveAcsePaytReq.tranTypeCd == 4))" style="position:absolute;right: 6px !important;top: -1px ;z-index: 200;font-size: 14px;"><a (click)="showLov('payee')"><i class="fa fa-search"></i></a></div>
                          </div>
                          <label class="form-control-sm col-sm-1">Request Date</label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <div class="col-sm-8 dp-cont">
                              <datepicker  [type]="'date'" [disabled]="(saveAcsePaytReq.reqStatus != 'N' && saveAcsePaytReq.reqStatus != 'F')" [required]="true" [value]="reqDateDate" (valueChange)="reqDateDate=$event;prepareData()"></datepicker>
                            </div>
                            <div class="col-sm dp-cont">
                              <datepicker  [type]="'time'" [disabled]="(saveAcsePaytReq.reqStatus != 'N' && saveAcsePaytReq.reqStatus != 'F')" [required]="true" [value]="reqDateTime" (valueChange)="reqDateTime=$event;"></datepicker>
                            </div>
                          </div>
                      </div> -->

                      <div class="input-group" style="margin-bottom: -14px !important;">
                          <label class="form-control-sm col-sm-1" style="height: auto;">Payee</label>
                          <div class="col-sm-7" style="padding: 0px;">
                            <div class="input-group"> 
                              <input name="input21" type="text" class="form-control form-control-sm cust-sm col-sm-1 warn payee" style="min-width: 71px !important;" maxlength="3" [ngModel]="saveAcsePaytReq.payeeCd" (ngModelChange)="saveAcsePaytReq.payeeCd=$event;" (change)="checkCode($event,'payee')" appRequired [disabled]="existsInReqDtl" numbers-only autoComplete="off">
                              <div style="margin-left: -18px !important;margin-right: 5px !important;z-index: 200;font-size: 14px;" *ngIf="!removeIcon && !existsInReqDtl"><a (click)="showLov('payee')"><i class="fa fa-search"></i></a></div>
                              <input name="input6" type="text" class="form-control form-control-sm cust-sm col-sm-12 warn" style="margin-left: 3px !important;" [ngModel]="saveAcsePaytReq.payee" (ngModelChange)="saveAcsePaytReq.payee=$event" appRequired autoComplete="off">
                            </div>
                          </div>

                          <label class="form-control-sm col-sm-1" style="margin-left: -2px !important;">Request Date</label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <div class="col-sm-8 dp-cont">
                              <datepicker  [type]="'date'" [disabled]="(saveAcsePaytReq.tranTypeCd == 1 || saveAcsePaytReq.tranTypeCd == 2 || saveAcsePaytReq.tranTypeCd == 3) || (saveAcsePaytReq.reqStatus != 'N' && saveAcsePaytReq.reqStatus != 'F')" [required]="true" [value]="reqDateDate" (valueChange)="reqDateDate=$event;prepareData()"></datepicker>
                            </div>
                            <div class="col-sm dp-cont" style="margin-right: -2px !important;">
                              <datepicker  [type]="'time'" [disabled]="(saveAcsePaytReq.tranTypeCd == 1 || saveAcsePaytReq.tranTypeCd == 2 || saveAcsePaytReq.tranTypeCd == 3) || (saveAcsePaytReq.reqStatus != 'N' && saveAcsePaytReq.reqStatus != 'F')" [required]="true" [value]="reqDateTime" (valueChange)="reqDateTime=$event;"></datepicker>
                            </div>
                          </div>
                      </div>

                      <div class="input-group">
                          <label class="form-control-sm col-sm-1 labels">Amount</label>
                             <div class="input-group col-sm-3" style="padding: 0px;">
                              <input name="input7" type="text" class="form-control form-control-sm cust-sm col-sm-2 warn curr cap-input" style="min-width: 71px !important;" maxlength="3" [ngModel]="saveAcsePaytReq.currCd" (ngModelChange)="saveAcsePaytReq.currCd=$event" (change)="checkCode($event,'curr')" appRequired [disabled]="(saveAcsePaytReq.tranTypeCd != 3 && saveAcsePaytReq.tranTypeCd != 4) && existsInReqDtl" autoComplete="off">
                              <div style="margin-left: -18px !important;margin-right: 5px !important;z-index: 200;font-size: 14px;" *ngIf="(!removeIcon && !existsInReqDtl) || ((saveAcsePaytReq.reqStatus == 'N' || saveAcsePaytReq.reqStatus == 'F') && (saveAcsePaytReq.tranTypeCd == 3 || saveAcsePaytReq.tranTypeCd == 4))"><a (click)="showLov('curr')"><i class="fa fa-search"></i></a></div>
                              <input name="input8" *ngIf="saveAcsePaytReq.reqStatus != 'X'" type="text" class="form-control form-control-sm cust-sm col-sm warn" style="text-align: right;margin-left: 3px !important;" [ngModel]="saveAcsePaytReq.reqAmt" (ngModelChange)="saveAcsePaytReq.reqAmt=$event" appRequired (change)="setLocalAmt();" numbers-only maxlength="24">
                              <input name="input8" *ngIf="saveAcsePaytReq.reqStatus == 'X'" type="text" class="form-control form-control-sm cust-sm col-sm-9 warn" style="text-align: right;margin-left: 3px !important;"  [(ngModel)]="saveAcsePaytReq.reqAmt"  numbers-only maxlength="26" readonly>
                             </div>
                             <label class="form-control-sm col-sm-1 labels">Currency Rate</label>
                             <!-- [ngModel]="saveAcsePaytReq.currRate | number:'1.10-10'" -->
                             <input name="input9" class="form-control form-control-sm cust-sm col-sm-3 warn text-right" type="text"  
                             [ngModel]="saveAcsePaytReq.currRate" 
                             (ngModelChange)="saveAcsePaytReq.currRate=$event" (change)="setLocalAmt();" maxlength="32" appRequired numbers-only [disabled]="(saveAcsePaytReq.tranTypeCd != 3 && saveAcsePaytReq.tranTypeCd != 4) && existsInReqDtl" autoComplete="off">
                             <label class="form-control-sm col-sm-1 labels">Local Amount</label>
                             <div class="input-group col-sm-3" style="padding: 0px;">
                                <input name="input10" type="text" class="form-control form-control-sm cust-sm col-sm-4" value="PHP" readonly>
                                <input name="input11" type="text" class="form-control form-control-sm cust-sm col-sm-8" [ngModel]="saveAcsePaytReq.localAmt" (ngModelChange)="saveAcsePaytReq.localAmt=$event" style="text-align: right; margin-left: 2px;" readonly>
                             </div>
                      </div>
                      <div class="input-group">
                          <label class="form-control-sm col-sm-1" style="height: auto;">Particulars</label>
                          <textarea name="textarea1" class="form-control form-control-sm warn particulars" style="font-size: 11px; min-height: 38px; margin-bottom: 5px;" [(ngModel)]="saveAcsePaytReq.particulars" maxlength="1000" appRequired autoComplete="off"></textarea>
                      </div>
                      <div class="input-group" style="    margin-bottom: -19px !important;">
                          <div class="input-group col-sm-4" style="padding: 0px;">
                          </div>
                          <div class="input-group col-sm-4" style="padding: 0px;">
                          </div>
                          <!-- <div class="input-group col-sm-4 labels" style="padding: 0px;">
                            <label class="form-control-sm col-sm-11 text-right">For Board Approval</label>
                              <input type="checkbox" class="col-sm-1 warn" style="margin-top: 6px;" checked>
                          </div> -->
                      </div>
                      <div class="input-group" style="margin-bottom: -5px !important;">
                          <label class="form-control-sm col-sm-1 labels">Prepared By</label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <input name="input12" type="text" class="form-control form-control-sm cust-sm col-sm-12 warn prep-user" (change)="checkCode($event,'prep-user')" [(ngModel)]="saveAcsePaytReq.preparedName" maxlength="10" appRequired autoComplete="off">
                            <div *ngIf="!removeIcon" style="margin-left: -19px !important;z-index: 200;font-size: 14px;"><a (click)="showLov('prep-user')"><i class="fa fa-search"></i></a></div>
                          </div>
                          <label class="form-control-sm col-sm-1 labels">Requested By</label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <input name="input13" type="text" class="form-control form-control-sm cust-sm col-sm-12 warn req-user" (change)="checkCode($event,'req-user')" [(ngModel)]="saveAcsePaytReq.requestedName" maxlength="10" appRequired autoComplete="off">
                            <div *ngIf="!removeIcon" style="margin-left: -19px !important;z-index: 200;font-size: 14px;"><a (click)="showLov('req-user')"><i class="fa fa-search"></i></a></div>
                          </div>
                          <label class="form-control-sm col-sm-1 labels">Approved By</label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <input name="input14" type="text" class="form-control form-control-sm cust-sm col-sm-12 warn" (change)="checkCode($event,'app-user')" [(ngModel)]="saveAcsePaytReq.approvedName" autoComplete="off">
                            <div *ngIf="!removeIcon" style="margin-left: -19px !important;z-index: 200;font-size: 14px;"><a (click)="showLov('app-user')"><i class="fa fa-search"></i></a></div>
                          </div>
                      </div>
                      <div class="input-group" style="margin-bottom: -5px !important;">
                          <label class="form-control-sm col-sm-1 labels"></label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <input name="input15" type="text" class="form-control form-control-sm cust-sm col-sm-12" [(ngModel)]="saveAcsePaytReq.preparedDes" readonly>
                          </div>
                          <label class="form-control-sm col-sm-1 labels"></label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <input name="input16" type="text" class="form-control form-control-sm cust-sm col-sm-12" [(ngModel)]="saveAcsePaytReq.requestedDes" readonly>
                          </div>
                          <label class="form-control-sm col-sm-1 labels"></label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                            <input name="input17" type="text" class="form-control form-control-sm cust-sm col-sm-12" [(ngModel)]="saveAcsePaytReq.approvedDes" readonly>
                          </div>
                      </div>
                      <div class="input-group" style="margin-bottom: -5px !important;">
                          <label class="form-control-sm col-sm-1 no-margin">Date Prepared</label>
                          <div class="col-sm-3 dp-cont" style="margin-left: 0px !important">
                            <datepicker type="datetime" [showIcon]="false" [showSeconds]="true" [disabled]="true" [value]="saveAcsePaytReq.preparedDate"></datepicker>
                          </div>
                          <label class="form-control-sm col-sm-1 labels"></label>
                          <div class="input-group col-sm-3" style="padding: 0px;">
                          </div>
                          <label class="form-control-sm col-sm-1 no-margin">Date Approved</label>
                          <div class="col-sm-3 dp-cont" style="margin-left: 0px !important">
                            <!-- <datepicker type="datetime" [showIcon]="false" [disabled]="true" [value]="saveAcsePaytReq.approvedDate"></datepicker> -->
                            <datepicker  [type]="'datetime'" [disabled]="(saveAcsePaytReq.reqStatus != 'N' && saveAcsePaytReq.reqStatus != 'F')" [required]="false" [value]="saveAcsePaytReq.approvedDate" (valueChange)="saveAcsePaytReq.approvedDate=$event;"></datepicker>
                          </div>
                      </div>
                  </div>
              </div>
              <div class="form-row">
                <div class="form-group col-sm" style="margin-bottom: 8px;">
                  <div class="col-md-13 text-center">
                    <div class="cust-btn-container">
                      <button type="button" class="cust-btn" (click) = "showConfirmMdl('new-req')">New Request</button>
                      <button type="button" class="cust-btn" [disabled]="(saveAcsePaytReq.reqStatus != 'N' && saveAcsePaytReq.reqStatus != 'F')" (click)="onClickSave()">Save</button>
                      <button type="button" class="cust-btn" [disabled] ="initDisabled || saveAcsePaytReq.reqStatus == 'X' || saveAcsePaytReq.reqStatus == 'P'" (click)="approvalCd='AC007';showConfirmMdl('cancel-req')">Cancel Request</button>
                      <button type="button" class="cust-btn" [disabled] ="initDisabled" (click)="printMdl.openNoClose()">Print</button>
                      <button type="button" class="cust-btn" style="min-width: 125px !important;" [disabled]="saveAcsePaytReq.reqStatus != 'F'" (click)="approvalCd='AC002';showConfirmMdl('approve')">Ok for Disbursement</button>
                    </div>
                  </div>
                </div>
              </div>
          </fieldset>
      </div>
  </div>
  <div class="col-sm-12" style="padding-left: 0px !important;padding-right: 0px !important;">
    <fieldset class="scheduler-border" style="margin-top: 10px !important;">
      <div class="input-group" style="margin-left: -13px !important;margin-top: 10px !important;">
        <label class="form-control-sm col-sm-1">Created By</label>
        <input name="input18" type="text" class="form-control form-control-sm col-sm" [(ngModel)]="saveAcsePaytReq.createUser" readonly>
        <label class="form-control-sm col-sm-1 no-margin">Date Created</label>
        <div class="col-sm dp-cont">
          <datepicker [showIcon]="false" [showSeconds]="true" [disabled]="true" [value]="saveAcsePaytReq.createDate"></datepicker>
        </div>
        <label class="form-control-sm col-sm-1">Last Update By</label>
        <input name="input19" type="text" class="form-control form-control-sm col-sm" [(ngModel)]="saveAcsePaytReq.updateUser" readonly>
        <label class="form-control-sm col-sm-1 no-margin">Last Update</label>
        <div class="col-sm dp-cont">
          <datepicker [showIcon]="false" [showSeconds]="true" [disabled]="true" [value]="saveAcsePaytReq.updateDate"></datepicker>
        </div>
      </div>
    </fieldset>
  </div>
</div>
</form>

<app-modal class="d-none" #confirmMdl >
    <div header>Confirmation</div>
    <div body class="container-flex text-center">
      <div *ngIf="fromBtn == 'approve'">
        <div class="input-group">
          <p class="col-sm-12">Are you sure you want to approve this Payment Request?</p>
        </div>
      </div>
      <div *ngIf="fromBtn == 'cancel-req'">
        <div class="input-group">
          <p class="col-sm-12">Are you sure you want to cancel this Payment Request?</p>
        </div>
      </div>
      <div *ngIf="fromBtn == 'new-req'">
        <div class="input-group">
          <p class="col-sm-12">There are some unsaved changes. Do you want to proceed?</p>
        </div>
      </div>
    </div>
    <div footer class="d-flex justify-content-center w-100">                    
        <button class="cust-btn" type="button" (click)="onYesConfirmed()">Yes</button>
        <button class="cust-btn" type="button" (click)="confirmMdl.closeModal();(fromBtn == 'new-req')?onClickNewReq():'';">No</button>
    </div>
</app-modal>

<app-modal class="d-none" #warnMdl >
    <div header style="min-width:460px !important;">Warning</div>
    <div body class="container-flex text-center">
      <pre style="font-family: inherit !important;width: inherit !important; margin-bottom: 0px !important;"><p style="margin-bottom: 0px !important;">{{ warnMsg }}</p></pre>
    </div>
    <div footer class="d-flex justify-content-center w-100">                    
        <button class="cust-btn" type="button" (click)="warnMdl.closeModal()">Ok</button>
    </div>
</app-modal>

  <app-modal class="d-none" #printMdl>
    <div header>Print Request</div>
    <div body>
        <div class="container-fluid">
            <div class="custom-row-inline-inset">
                <div class="input-group">
                    <div class="col-sm-4"></div>
                    <!-- <div class="input-group col-sm-3 labels" style="padding: 0px;">
                        <input type="checkbox" style="margin-top: 6px;" checked>
                        <label class="form-control-sm" for="xx">CV</label>
                    </div>
                    <div class="input-group col-sm-3 labels" style="padding: 0px;">
                        <input type="checkbox" style="margin-top: 6px;" checked>
                        <label class="form-control-sm" for="xx">Check</label>
                    </div> -->
                </div>
                <div class="input-group">
                  <label class="form-control-sm col-sm-4 labels">Destination</label>
                  <select name="select2" class="form-control form-control-sm cust-sm col-sm-8" [ngModel]="printData.destination" (ngModelChange)="printData.destination=$event;clearPrinterName();">
                      <option value="screen">Screen</option>
                      <option value="printer">Printer</option>
                  </select>
                </div>
                <div class="input-group">
                    <label class="form-control-sm col-sm-4 labels">Printer Name</label>
                    <select name="select3" class="form-control form-control-sm cust-sm col-sm-8" [ngModel]="printData.selPrinter" (ngModelChange)="printData.selPrinter=$event;" [disabled]="printData.destination != 'printer'">
                        <ng-container *ngFor="let printer of printData.printers">
                            <option [value]="printer">{{ printer }}</option>    
                        </ng-container>
                    </select>
                </div>
                <!-- <div class="input-group">
                    <label class="form-control-sm col-sm-4 labels">No. of Copies</label>
                    <input name="input20" type="number" class="form-control form-control-sm cust-sm col-sm-8 text-right">
                </div> -->
            </div>
        </div>
    </div>
    <div footer class="text-center w-100">
        <button class="cust-btn" type="button" (click)="printMdl.closeModal()"><a>Cancel</a></button>
        <button class="cust-btn" type="button" (click)="printMdl.closeModal();onClickPrint()"  [disabled]="printData.destination == '' || (printData.destination == 'printer')?(printData.selPrinter == '')?true:false:false">Print</button>
    </div>
  </app-modal>

<app-confirm-save (onYes)="onSaveAcsePaytReq()"></app-confirm-save>
<app-sucess-dialog [icon]="dialogIcon" [message]="dialogMessage" (onOk)="checkCancel();"></app-sucess-dialog>
<app-cancel-button (onYes)="onClickSave('cancel')" [url]="'/payt-req'" ></app-cancel-button>

<app-lov #mainLov [passData]="passDataLov" (selectedData)="setData($event,'payee')"></app-lov>
<app-mtn-currency #currLov (selectedData)="setData($event,'curr')"></app-mtn-currency>
<app-mtn-printable-names #prepUserLov (selectedData)="setData($event,'prep-user')"></app-mtn-printable-names>
<app-mtn-printable-names #reqUserLov (selectedData)="setData($event,'req-user')"></app-mtn-printable-names>
<app-mtn-printable-names #appUserLov (selectedData)="setData($event,'app-user')"></app-mtn-printable-names>
<app-override-login [approvalCd]="approvalCd" (isSuccess)="onOkOverride($event)" #override></app-override-login>
