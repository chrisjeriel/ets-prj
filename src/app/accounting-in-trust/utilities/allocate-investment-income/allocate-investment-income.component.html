<img src="app/resources/images/Loading_icon2.gif" alt="loading.gif" id="loading" class="" style="position: absolute;top:50%;left:50%;-ms-transform: translate(-50%,-50%);transform: translate(-50%,-50%);z-index: 999999" *ngIf="loading">
<div style="position: fixed;width: 100%;height: 100%;z-index: 991;background-color: rgba(255, 255, 255, 0.5);" *ngIf="loading"></div>
<div class="cust-tabs-container">
	<h4>Accounting In-Trust / Utilities / Allocate Investment Income</h4>
		<!-- <ngb-tabset (tabChange)="onTabChange($event)"> TRBT#PROD_GRADE -->
		<ngb-tabset>
			<ngb-tab class="ngb-tab" title="Allocate Investment Income">
				<ng-template ngbTabContent>
					<div>
						 <fieldset class="scheduler-border">
						 	<legend class="scheduler-border">Filter Options</legend>
						 	
						 		<!-- <div class="form-row custom-row-inline-inset"> -->
						 			
									<div class="input-group">
										<div class="col-sm-3"></div>
										<div class="input-group col-sm-6">
											<label class="form-control-sm col-sm-2" for="byDate">&nbsp;Period:</label>
											<label class="form-control-sm from col-sm-1" for="fromDate">From</label>
											<div class="col-sm-3 dp-cont" style="margin-left: 0 !important;">
												<datepicker [type]="'date'" [showIcon]="true" [value]="fromDate.split('T')[0]" (valueChange)="fromDate=$event"></datepicker>
											</div>
											<label class="form-control-sm col-sm-1">To</label>
											<div class="col-sm-3 dp-cont" style="margin-left: 0 !important;">
												<datepicker [type]="'date'" [showIcon]="true" [value]="toDate.split('T')[0]" (valueChange)="toDate=$event"></datepicker>
											</div>
											<span class="col-sm"></span>
										</div>
										<div class="col-sm-3"></div>
									</div>
									<div class="input-group" style="margin-bottom: 0 !important;">
										<div class="col-sm-3"></div>
										<div class="input-group col-sm-6">
											<label class="form-control-sm col-sm-3">Currency</label>
											<input type="text" class="form-control form-control-sm col-sm-2" [ngModel]="currCd" (ngModelChange)="currCd = $event.toUpperCase()" (change)="checkCode($event)">
											<div class="text-search-ico"><a><i class="fa fa-search" (click)="showCurrencyModal()"></i></a></div>
											<span>&nbsp;</span>
											<input type="text" class="form-control form-control-sm col-sm cap-input" [ngModel]="currency" readonly>
											<span class="col-sm-2"></span>
										</div>
										<div class="col-sm-3"></div>
									</div>
								<!-- </div> -->

								<!-- <div class="form-row custom-row-inline-inset">
									<div class="input-group" style="margin-top: -11px;">
										<div class="col-sm-3"></div>
										<input class="form-control-sm " type="radio" name="optradio" id="byMonthYear" value="bymoyo" [(ngModel)]="radioVal" (click)="clearDates()">
										<label class="form-control-sm text-left" for="byMonthYear">Month/Year</label>
										<select id="m-list" [(ngModel)]="fromMonth" class="form-control form-control-sm cust-sm col-sm-3" name="fromMonth" [disabled]="radioVal != 'bymoyo'" style="margin-left: 2px">
											<option *ngFor="let m of monthList" [value]="m.key">{{ m.value }}</option>
										</select>
										<label class="form-control-sm cust-sm"></label>
										<select id="y-list" [(ngModel)]="fromYear" class="form-control form-control-sm cust-sm col-sm-3" type="text" name="fromYear" [disabled]="radioVal != 'bymoyo'">
											<option *ngFor="let y of yearList" [value]="y">{{ y }}</option>
										</select>
										<div class="col-sm-3"></div>
									</div>
								</div>
								<div class="form-row custom-row-inline-inset">
									<div class="input-group" style="margin-top: -11px;">
										<div class="col-sm-3"></div>
										<input class="form-control-sm " type="radio" name="optradio" id="byYear" value="byyear" [(ngModel)]="radioVal" (click)="clearDates()">	
										<label class="form-control-sm" for="byYear">&nbsp;As of</label>
										<div class="col-sm dp-cont" style="margin-left: 30px ! important">
											<datepicker [type]="'date'" [showIcon]="true" [value]="asOfYear" (valueChange)="asOfYear=$event" [disabled]="radioVal != 'byyear'"></datepicker>
										</div>
										<div class="col-sm-3"></div>
								    </div>
								</div> -->
								<div class="form-row custom-row-inline-inset">
									<div class="input-group" style="margin-top: -11px;">
										<div class="w-100 text-center" style="margin-bottom: 6px">
									        <button class="cust-btn" type="button" (click)="onClickSearch()"><a>Search</a></button>
									    </div>
									</div>
								</div>
						 </fieldset>

					</div>
					<div>
						 <fieldset class="scheduler-border">
						 	<legend class="scheduler-border">List of Transactions for Allocation</legend>
						 		<div class="row">
						 			 <div class="col-sm-12" style="margin-bottom: -20px; margin-top: 10px" >
						 			 	  <app-cust-editable-non-datatable [passData]="passData" (newClick)="onRowClick($event)" (rowDblClick)="onRowDblClick($event)" (tableDataChange)="update($event);"></app-cust-editable-non-datatable>
						 			 </div>
						 		</div>
						 		<div class="form-row custom-row-inline-inset">
									<div class="input-group" style="margin-top: 10px;">
										<div class="w-100 text-center" style="margin-bottom: 6px">
									        <button class="cust-btn" type="button" (click)="onClickView()" ><a>View Details</a></button>
									        <!-- <button class="cust-btn" type="button" (click)="onClickAllocate()" [disabled]="boolAllocate"><a>Allocate</a></button> -->
									    </div>
									</div>
								</div>
						 </fieldset>
					</div>
					<div>
						 <fieldset class="scheduler-border">
						 	<legend class="scheduler-border">Allocate</legend>
						 		<div class="form-row custom-row-inline-inset">
									<!-- <div class="input-group" style="margin-top: 10px;">
										<div class="w-100 text-center" style="margin-bottom: 6px">
									        <button class="cust-btn" type="button" (click)="onClickView()" ><a>View Details</a></button>
									        <button class="cust-btn" type="button" (click)="onClickAllocate()" [disabled]="boolAllocate"><a>Allocate</a></button>

									        <label class="form-control-sm col-sm-1">Transaction Date</label>
											<div class="col-sm-3 dp-cont" style="margin-left: 0 !important;">
												<datepicker [type]="'date'" [showIcon]="true" [value]="toDate.split('T')[0]" (valueChange)="toDate=$event"></datepicker>
											</div>
									    </div>
									</div> -->
									<div class="input-group">
										<div class="col-sm-3"></div>
										<div class="input-group col-sm-6">
											<label class="form-control-sm from col-sm-4">Transaction Date</label>
											<div class="col-sm-3 dp-cont" style="margin-left: 0 !important;">
												<datepicker [type]="'date'" [showIcon]="true" [value]="allocTranDate?.split('T')[0]" (valueChange)="allocTranDate=$event"></datepicker>
											</div>
											<button class="cust-btn" type="button" (click)="onClickAllocate()" style="height: calc(1.3rem + 1px) !important; padding: 0 8px !important; z-index: 1 !important; margin-left: 5px;"><a>Allocate</a></button>
											<span class="col-sm"></span>
										</div>
										<div class="col-sm-3"></div>
									</div>
								</div>
						 </fieldset>
					</div>
				</ng-template>
			</ngb-tab>
		</ngb-tabset>
</div>
<app-sucess-dialog [icon]="dialogIcon" [message]="dialogMessage"></app-sucess-dialog>

<app-modal [btnTitle]="'Transaction Details'" hidden id="modalProfComm" #queryMdl>
    <div header>Transaction Details</div>
         <div body>
            <div style="width: 1000px">
            	<div class="input-group">
                    <div class="col-sm-1"></div>
                    <div class="col-sm">
	                    <fieldset class="scheduler-border" style="padding-left: 0px ! important">
	                    <br />
		                    <div class="form-row custom-row-inline-inset" style="margin-top: -10px !important;margin-bottom: 12px !important;">
		                        <div class="input-group alignment" style="margin-bottom: -13px !important;">
		                            <label class="form-control-sm col-sm-2 text-right">Transaction No.</label>
		                            <input type="text" class="form-control form-control-sm cust-sm col-sm" readonly  [(ngModel)]="tranNo">
		                            <label class="form-control-sm col-sm-1 text-right">Tran Date</label>
		                            <!-- <input type="text" class="form-control form-control-sm cust-sm col-sm" readonly [(ngModel)]="tranDate"> -->
		                            <div class="dp-cont col-sm" style="margin-left: 0 !important;">
		                            	<datepicker [type]="'date'" [value]="tranDate?.split('T')[0]" [disabled]="true"></datepicker>
		                            </div>
		                            <label class="form-control-sm col-sm-1 text-right">Status</label>
		                            <input type="text" class="form-control form-control-sm cust-sm col-sm" readonly [(ngModel)]="status">
		                        </div>
		                     </div>
		                     <div class="form-row custom-row-inline-inset" style="margin-top: -13px !important;">
		                        <div class="input-group alignment" style="margin-bottom: -13px !important;">
		                            <label class="form-control-sm col-sm-2 text-right">Payor</label>
		                            <input type="text" class="form-control form-control-sm cust-sm col-sm-10" readonly [(ngModel)]="payor" >
		                        </div>
		                     </div>
	               		 </fieldset>
	               	</div>
                    <div class="col-sm-1"></div>
                </div>
                <div class="row">
					<div class="col-sm-12" style="margin-top: 14px; margin-bottom: -20px" >
					     <app-cust-editable-non-datatable #invtTable [passData]="passDataInvt"> </app-cust-editable-non-datatable>
					</div>
            	</div>
          	</div>
          </div>
          	<div footer class="text-center" style="width: 100% !important;">
                <button type="button" class="cust-btn" (click)="queryModal.closeModal()"><a>Return</a></button>
          	</div>
</app-modal>

<app-modal [btnTitle]="'Allocation Successful!'" hidden id="modalAllocSuccess" #successMdl>
    <div header>Allocation Successful!</div>
         <div body>
            <div style="width: 900px">
            	<div class="input-group">
                    <div class="col-sm-1"></div>
                    <div class="col-sm">
                    	 <div class="custom-row-inline-inset" style="text-align: center"> 
			            	<p style="margin-bottom: 1px;font-size: 15px">Investment income from period of {{ fromDate | date:'MMMM dd, yyyy' }} to {{ toDate | date:'MMMM dd, yyyy' }} were successfully allocated.</p>
			            	<p *ngIf="radioVal == 'bymoyo'" style="margin-bottom: 1px;font-size: 15px">Investment income for the period were successfully allocated.</p>
			            	<p *ngIf="radioVal == 'byyear'" style="margin-bottom: 1px;font-size: 15px">Investment income as of {{ asOfYear | date:'MMMM dd,yyyy' }} were successfully allocated.</p>
			            	<p style="font-size: 15px"> Please see below JV Nos. generated.</p>
			            </div>
	               	</div>
                    <div class="col-sm-1"></div>
                </div>
                <div class="row">
					<div class="col-sm-12" style="margin-top: 4px; margin-bottom: -5px" >
					     <app-cust-editable-non-datatable #jvTable [passData]="passDataJv"> </app-cust-editable-non-datatable>
					</div>
            	</div>
          	</div>
          </div>
          	<div footer class="text-center" style="width: 100% !important;">
                <button type="button" class="cust-btn" (click)="successMdl.closeModal()"><a>OK</a></button>
          	</div>
</app-modal>

<app-mtn-currency-code #currencyModal id="currencyModal" (selectedData)="setCurrency($event)"></app-mtn-currency-code>
