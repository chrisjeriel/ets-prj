<div class="cust-tabs-container">
  <h4>Claims</h4>
  <ngb-tabset>
    <ngb-tab title="Change Claim Status">
      <ng-template ngbTabContent>
        <div class="custom-row-inline-inset">
          <div class="row">
            <div class="col-sm-10">
              <app-cust-editable-non-datatable [passData]="queryData" (newClick)="onRowClickQuery($event)" #queryTbl></app-cust-editable-non-datatable>
            </div>
            <div class="col-sm-2">
              <fieldset class="scheduler-border">
                <legend class="scheduler-border">Change Status To</legend>
                <div class="custom-row-inline-inset">
                  <div>
                    <div class="form-row" *ngIf="batchOptionLoading">
                      <img src="app/resources/images/Loading_icon2.gif" alt="loading.gif" id="loading" class="">
                    </div>
                    <!-- <div class="form-row">
                      <input type="radio" class="form-control-sm" [ngModel]="batchOption" (ngModelChange)="batchOption = $event; clearDetails(); searchParams.batchOpt = batchOption; retrieveQueryList();" [value]="'IP'" name="batchOption"><label class="rd-lbl">In Progress</label>
                    </div>
                    <div class="form-row">
                      <input type="radio" class="form-control-sm" [ngModel]="batchOption" (ngModelChange)="batchOption = $event; clearDetails(); searchParams.batchOpt = batchOption; retrieveQueryList();" [value]="'TC'" name="batchOption"><label class="rd-lbl">Temporary Close</label>
                    </div>
                    <div class="form-row">
                      <input type="radio" class="form-control-sm" [ngModel]="batchOption" (ngModelChange)="batchOption = $event; clearDetails(); searchParams.batchOpt = batchOption; retrieveQueryList();" [value]="'CD'" name="batchOption"><label class="rd-lbl">Close</label>
                    </div>
                    <div class="form-row">
                      <input type="radio" class="form-control-sm" [ngModel]="batchOption" (ngModelChange)="batchOption = $event; clearDetails(); searchParams.batchOpt = batchOption; retrieveQueryList();" [value]="'WD'" name="batchOption"><label class="rd-lbl">Withdraw</label>
                    </div>
                    <div class="form-row">
                      <input type="radio" class="form-control-sm" [ngModel]="batchOption" (ngModelChange)="batchOption = $event; clearDetails(); searchParams.batchOpt = batchOption; retrieveQueryList();" [value]="'SP'" name="batchOption"><label class="rd-lbl">Spoil</label>
                    </div>
                    <div class="form-row">
                      <input type="radio" class="form-control-sm" [ngModel]="batchOption" (ngModelChange)="batchOption = $event; clearDetails(); searchParams.batchOpt = batchOption; retrieveQueryList();" [value]="'DN'" name="batchOption"><label class="rd-lbl">Deny</label>
                    </div> -->
                    <!-- <div class="form-row" *ngFor="let status of arrClaimStatus">
                      <input type="radio" class="form-control-sm" [ngModel]="batchOption" (ngModelChange)="batchOption = $event; batchOptionDesc = status.description; clearDetails(); queryData.tableData = []; queryTable.refreshTable(); queryTable.selected = [];" [value]="status.statusCode" name="batchOption"><label class="rd-lbl">{{status.description}}</label>
                    </div> -->
                    <div class="form-row" *ngIf="!batchOptionLoading">
                      <div class="input-group" style="margin-bottom: 0px !important">
                        <select class="form-control form-control-sm cust-sm col-sm" [ngModel]="batchOption" (ngModelChange)="changeBatchOption($event);">
                          <option *ngFor="let status of arrClaimStatus" [ngValue]="status">{{status.description}}</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </fieldset>

              <div class="form-row">
                <div class="form-group col-sm">
                  <div class="text-center" class="min-width: 100% !important;">
                    <div class="cust-btn-container">
                      <div class="input-group" style="margin-bottom: 3px !important;">
                        <button type="button" class="cust-btn" style="z-index: 0 !important;min-width: 100% !important; margin-top: 3px !important;" [class.cust-btn-disabled]="processBtnDisabled || queryTable?.selected.length === 0" [disabled]="processBtnDisabled || queryTable?.selected.length === 0" (click)="process()"><a>Process</a></button>
                      </div>
                      <div class="input-group">
                        <button type="button" id="searchBtn" class="cust-btn" style="z-index: 0 !important; min-width: 100% !important;"
                          (click)="search($event)"><a>Search</a></button>
                        <app-modal [btnTitle]="'Search'" hidden id="modalSearch" #queryMdl>
                          <div header>Search</div>
                          <div body>
                            <img src="app/resources/images/Loading_icon2.gif" alt="loading.gif" id="loading" class="" style="position: absolute;top:50%;left:50%;-ms-transform: translate(-50%,-50%);transform: translate(-50%,-50%);z-index: 999999" *ngIf="searchLoading">
                                            <div style="position: fixed;width: 47%;height: 62%;z-index: 991;background-color: rgba(255, 255, 255, 0.5);" *ngIf="searchLoading"></div>
                            <div style="width: 600px">
                              <fieldset class="scheduler-border">
                                <br />
                                <div class="form-row custom-row-inline-inset" style="margin-top: -5px !important;margin-bottom: 12px !important;">
                                    <div class="input-group alignment" style="margin-bottom: -13px !important;">
                                        <label class="form-control-sm col-sm-2 text-right">Claim No</label>
                                        <input type="text" class="form-control form-control-sm col-sm-1" [ngModel]="tempClmNo[0]" (ngModelChange)="tempClmNo[0] = $event.toUpperCase();" (change)="checkClaim('line', $event)" ngbTooltip="Line">
                                        <input type="text" class="form-control form-control-sm col-sm-1" [(ngModel)]="tempClmNo[1]" (change)="checkClaim('year', $event)" ngbTooltip="Year" style="margin-left: 2px">
                                        <input type="text" class="form-control form-control-sm col-sm-2" [(ngModel)]="tempClmNo[2]" (change)="checkClaim('seqNo', $event)" ngbTooltip="Sequence No." style="margin-left: 2px">
                                        <a style="margin-left: 5px;" (click)="openClmListing();"><i class="fa fa-search"></i></a>
                                    </div>
                                </div>
                                <div class="form-row custom-row-inline-inset" style="margin-top: -5px !important;">
                                    <div class="input-group alignment" style="margin-bottom: -13px !important;">
                                        <label class="form-control-sm col-sm-2 text-right">Policy No</label>
                                        <input type="text" class="form-control form-control-sm" ngbTooltip="Line" [ngModel]="tempPolNo[0]" (ngModelChange)="tempPolNo[0] = $event.toUpperCase();" (change)="checkPol('line', $event)">
                                        <input type="text" class="form-control form-control-sm" ngbTooltip="Year" style="margin-left: 2px" [(ngModel)]="tempPolNo[1]" (change)="checkPol('year', $event)">
                                        <input type="text" class="form-control form-control-sm" ngbTooltip="Sequence No." style="margin-left: 2px" [(ngModel)]="tempPolNo[2]" (change)="checkPol('seqNo', $event)">
                                        <input type="text" class="form-control form-control-sm" ngbTooltip="Ceding Company ID" style="margin-left: 2px" [(ngModel)]="tempPolNo[3]" (change)="checkPol('cedingId', $event)">
                                        <input type="text" class="form-control form-control-sm" ngbTooltip="Company Series No." style="margin-left: 2px" [(ngModel)]="tempPolNo[4]" (change)="checkPol('coSeriesNo', $event)">
                                        <input type="text" class="form-control form-control-sm" ngbTooltip="Alteration No." style="margin-left: 2px" [(ngModel)]="tempPolNo[5]" (change)="checkPol('altNo', $event)">
                                        <a style="margin-left: 5px;" (click)="openPolListing();"><i class="fa fa-search"></i></a>
                                    </div>
                                </div>
                                <div class="form-row custom-row-inline-inset">
                                    <div class="input-group alignment" style="margin-bottom: -13px !important;">
                                        <label class="form-control-sm col-sm-2 text-right">Type of Cession</label>
                                        <input type="text" id="typeOfCessionId" class="form-control form-control-sm col-sm-2" [(ngModel)]="searchParams.cessionId" (change)="checkCode($event, 'typeOfCession')">
                                        <div class="text-search-ico"><a (click)="openTypeOfCessionLOV()"><i class="fa fa-search"></i></a></div>
                                        <input type="text" class="form-control form-control-sm col-sm-8" style="margin-left: 2px !important;" tabindex="-1" readonly [ngModel]="searchParams.cessionDesc">
                                    </div>
                                </div>
                                <div class="form-row custom-row-inline-inset">
                                    <div class="input-group alignment" style="margin-bottom: -13px !important;">
                                        <label class="form-control-sm col-sm-2 text-right" style="padding-left: 0px">Ceding Company</label>
                                        <input type="text" id="cedingId" class="form-control form-control-sm col-sm-2" [(ngModel)]="searchParams.cedingId" (change)="checkCode($event, 'cedingCo')">
                                        <div class="text-search-ico"><a (click)="openCedingCompanyLOV();"><i class="fa fa-search"></i></a></div>
                                        <input type="text"class="form-control form-control-sm col-sm-8" style="margin-left: 2px !important;" tabindex="-1" readonly [ngModel]="searchParams.cedingName">
                                    </div>
                                </div>
                                <div class="form-row custom-row-inline-inset">
                                    <div class="input-group alignment" style="margin-bottom: -20px !important;">
                                        <label class="form-control-sm col-sm-2 text-right">Risk</label>
                                        <input type="text" id="riskCd" class="form-control form-control-sm col-sm-2" [(ngModel)]="searchParams.riskId" (change)="checkCode($event, 'risk')">
                                        <div class="text-search-ico"><a (click)="openRiskLOV()"><i class="fa fa-search"></i></a></div>
                                        <input type="text" class="form-control form-control-sm col-sm-8" style="margin-left: 2px !important;" tabindex="-1" readonly [ngModel]="searchParams.riskName">
                                    </div>
                                </div>
                                <br>
                            </fieldset>
                            </div>
                          </div>
                          <div footer class="text-center" style="width: 100% !important;">
                            <button type="button" class="cust-btn" (click)="clearSearchFields();"><a>Clear</a></button>
                            <button type="button" class="cust-btn" (click)="queryModal.closeModal()"><a>Cancel</a></button>
                            <button type="button" class="cust-btn" (click)="validateSearch();"><a>Ok</a></button>
                          </div>
                        </app-modal>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>

        <div class="custom-row-inline-inset">
          <div class="row">
            <div class="col-sm-10" style="margin-top: -25px !important;">
              <fieldset class="scheduler-border" style="margin-left: -7px !important;">
                <legend class="scheduler-border" style="visibility: hidden; padding-top: 24px !important; padding-left: 0px !important; padding-right: 0px !important;"></legend>
                <div class="custom-row-inline-inset" style="margin-left: -26px !important;">
                  <div class="row">
                    <div class="col-sm-6">
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Claim No</label>
                        <input type="text" class="form-control form-control-sm cust-sm"
                          readonly [ngModel]="claimDetails.claimNo">
                        <label class="form-control-sm col-sm-2">Status</label>
                        <input type="text" class="form-control form-control-sm cust-sm" 
                          readonly [ngModel]="claimDetails.clmStatus">
                      </div>
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Policy No</label>
                        <input type="text" class="form-control form-control-sm cust-sm"
                          readonly [ngModel]="claimDetails.policyNo">
                      </div>
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Ceding Co</label>
                        <input type="text" class="form-control form-control-sm cust-sm"
                          readonly [ngModel]="claimDetails.cedingName">
                      </div>
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Insured</label>
                        <input type="text" class="form-control form-control-sm cust-sm"
                          readonly [ngModel]="claimDetails.insuredDesc">
                      </div>
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Risk</label>
                        <textarea class="form-control form-control-sm col-sm" style="font-size: 11px; min-height: 47px; margin-bottom: 17px;"
                          readonly [ngModel]="claimDetails.riskName"></textarea>
                      </div>
                    </div>

                    <div class="col-sm-6">
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Loss Date</label>
                        <input type="text" class="form-control form-control-sm cust-sm" 
                          readonly [ngModel]="claimDetails.lossDate">
                        <label class="form-control-sm col-sm-2">Currency</label>
                        <input type="text" class="form-control form-control-sm cust-sm" readonly [ngModel]="claimDetails.currencyCd">
                      </div>
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Loss Details</label>
                        <textarea class="form-control form-control-sm col-sm" style="font-size: 11px; min-height: 47px; margin-bottom: 9px;"
                          readonly [ngModel]="claimDetails.lossDtl"></textarea>
                      </div>
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Total Reserve</label>
                        <input type="text" class="form-control form-control-sm cust-sm text-right" 
                          readonly [ngModel]="claimDetails.totalLossExpRes | number: '1.2-2'">
                        <label class="form-control-sm col-sm-2" style="padding-right: 3px !important;">Total
                          Payment</label>
                        <input type="text" class="form-control form-control-sm cust-sm text-right" 
                          readonly [ngModel]="claimDetails.totalLossExpPd | number: '1.2-2'">
                      </div>
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Adjusters</label>
                        <input type="text" class="form-control form-control-sm cust-sm"
                          readonly [ngModel]="claimDetails.adjName">
                      </div>
                      <div class="input-group">
                        <label class="form-control-sm col-sm-2">Processed By</label>
                        <input type="text" class="form-control form-control-sm cust-sm" readonly [ngModel]="claimDetails.processedBy">
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="row">
                    <div class="col-sm-12">
                      <div class="input-group">
                        <label class="form-control-sm col-sm-1" style="margin-left:-3px !important;">Reason</label>
                        <input type="text" class="form-control form-control-sm cust-sm col-sm-1"
                           required [readonly]="batchOption.openTag === 'Y'" [ngModel]="reasonCd" (ngModelChange)="reasonCd = $event.toUpperCase();" (change)="checkCode($event, 'reason')">
                        <div class="text-search-ico" *ngIf="batchOption.openTag !== 'Y'">
                          <a (click)="openReasonLOV()"><i class="fa fa-search"></i></a></div>
                        <input type="text" class="form-control form-control-sm cust-sm col-sm"
                           readonly style="margin-left: 2px !important" [ngModel]="reasonDesc">
                      </div>
                    </div>

                  </div>
                </div>
              </fieldset>
            </div>
          </div>
        </div>
      </ng-template>
    </ngb-tab>
  </ngb-tabset>
</div>

<!-- LOV MODALS STARTS HERE -->
<app-modal hidden [btnTitle]="'List Of Values'" id="lovMdl" #clmListMdl>
    <div header>List Of Values</div>
    <div body>
       <app-cust-non-datatable [passData]="clmListData" (rowClick)="selectedClaim=$event" #clmListTable></app-cust-non-datatable>
    </div>
    <div footer class="text-center w-100">
        <div class="col-sm-12 text-center">
        <button class="cust-btn" type="button" (click)="clmListModal.closeModal();"><a>Cancel</a></button>
        <button class="cust-btn" type="button" (click)="clmListModal.closeModal(); setClaim();"><a>Ok</a></button>
        </div>
    </div>
</app-modal>

<app-modal hidden [btnTitle]="'List Of Values'" #polListMdl>
    <div header>List Of Values</div>
    <div body>
       <app-cust-non-datatable [passData]="polListData" (rowClick)="selectedPolicy=$event" #polListTable></app-cust-non-datatable>
    </div>
    <div footer class="text-center w-100">
        <div class="col-sm-12 text-center">
        <button class="cust-btn" type="button" (click)="polListModal.closeModal();"><a>Cancel</a></button>
        <button class="cust-btn" type="button" (click)="polListModal.closeModal(); setPolicy();"><a>Ok</a></button>
        </div>
    </div>
</app-modal>

<app-modal class="d-none" #reasonMdl>
  <div header>List of Values</div>
  <div body>
    <app-cust-non-datatable [passData]="reasonData" (rowClick)="selectedReason = $event" #reasonListTable></app-cust-non-datatable>
  </div>
  <div footer>
        <div class="d-flex justify-content-center text-center">
          <div class="col-sm-12 text-center">
            <button class="cust-btn" type="button" (click)="reasonModal.closeModal();"><a>Cancel</a></button>
            <button class="cust-btn" type="button" (click)="reasonModal.closeModal(); setReason();" [disabled]="selectedReason === null" [class.cust-btn-disabled]="selectedReason === null"><a>Ok</a></button>
          </div>
        </div>
    </div>
</app-modal>

<app-modal class="d-none" #processPrompt>
  <div header>Confirmation</div>
  <div body>
    <span style="vertical-align: middle; margin-left: 5px;font-size: 1em;">{{dialogMessage}}</span>
  </div>
  <div footer>
        <div class="d-flex justify-content-center text-center">
          <div class="col-sm-12 text-center">
            <button class="cust-btn" type="button" (click)="processModal.closeModal(); updateClaimStatus();"><a>Yes</a></button>
            <button class="cust-btn" type="button" (click)="processModal.closeModal();"><a>No</a></button>
          </div>
        </div>
    </div>
</app-modal>

<app-modal class="d-none" #processedList>
  <div header>Change Claim Status</div>
  <div body>
    <app-cust-non-datatable [passData]="processedListData" #processedClaimsTbl></app-cust-non-datatable>
  </div>
  <div footer>
        <div class="d-flex justify-content-center text-center">
          <div class="col-sm-12 text-center">
            <button class="cust-btn" type="button" (click)="processedListModal.closeModal();"><a>Ok</a></button>
          </div>
        </div>
    </div>
</app-modal>

<app-mtn-risk id="riskLOV" (selectedData)="setRisks($event)" #riskMdl></app-mtn-risk>
<app-ceding-company id="cedingCompanyLOV" (selectedData)="setCedingcompany($event)" #cedCoMdl></app-ceding-company>
<app-mtn-type-of-cession id="typeOfCessionLOV" (selectedData)="setTypeOfCession($event)" #cessionMdl></app-mtn-type-of-cession>
<app-sucess-dialog [icon]="dialogIcon" [message]="dialogMessage" (onOk)="cancelFlag ? this.cancelBtn.onNo():null;" #successDiagSave></app-sucess-dialog>
