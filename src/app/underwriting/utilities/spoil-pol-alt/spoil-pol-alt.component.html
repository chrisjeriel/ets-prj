<div class="cust-tabs-container">
	<h4>Policy / Utilities</h4>
	<ngb-tabset #tabset (tabChange)="onTabChange($event)">
		<ngb-tab title="Spoil Policy/Alteration" id="mainScreen">
			<ng-template ngbTabContent>
				<fieldset class="scheduler-border fldst">
					<div class="form-row custom-row-inline-inset">
						<div class="input-group">
							<div class="col-sm-2"></div>
							<label class="form-control-sm col-sm-1">Policy No</label>
							<input type="text" class="form-control form-control-sm col-sm-1 cap-input" style="margin-left: 3px;" ngbTooltip="Line" [(ngModel)] = "spoilPolRecord.line" (change)="search('lineCd',$event)" maxlength="7" appRequired>
							<input type="text" class="form-control form-control-sm col-sm-1 cap-input" style="margin-left: 3px;" ngbTooltip="Year" [(ngModel)] = "spoilPolRecord.year" (change)="search('year',$event)" numbers-only maxlength="4" appRequired>
							<input type="text" class="form-control form-control-sm col-sm   cap-input text-right" style="margin-left: 3px;" ngbTooltip="Sequence No" [(ngModel)] = "spoilPolRecord.seqNo" (change)="search('seqNo',$event)" numbers-only maxlength="5" appRequired>
							<input type="text" class="form-control form-control-sm col-sm-1 cap-input text-right" style="margin-left: 3px;" ngbTooltip="Company Code" [(ngModel)] = "spoilPolRecord.coCode" (change)="search('cedingId',$event)" maxlength="3" appRequired>
							<input type="text" class="form-control form-control-sm col-sm-1 cap-input text-right" style="margin-left: 3px;" ngbTooltip="Co Series No" [(ngModel)] = "spoilPolRecord.coSeriesNo" (change)="search('coSeriesNo',$event)" numbers-only maxlength="4" appRequired>
							<input type="text" class="form-control form-control-sm col-sm-1 cap-input text-right" style="margin-left: 3px;" ngbTooltip="Alt No" [(ngModel)] = "spoilPolRecord.altNo" (change)="search('altNo',$event)" numbers-only maxlength="3" appRequired>
							<span>&nbsp;</span>
							<div><a (click)="show()"><i class="fa fa-search"></i></a></div>
							<div class="form-row">
								<div class="form-group">
									<div class="col-md-12 text-center">
										<div class="cust-btn-container">
											<button type="button" class="cust-btn" (click)="clearAll()"><a>Clear</a></button>
										</div>
									</div>
								</div>
							</div>
							<div class="col-sm-2"></div>
						</div>
					</div>
				</fieldset>

				<fieldset class="scheduler-border">
					<legend class="scheduler-border">Policy Record</legend>
					<div class="custom-row-inline-inset">
						<div class="form-row">
							<div class="col-sm-6">
								<div class="input-group">
									<label class="form-control-sm col-sm-3">Ceding Company</label>
									<input type="text" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.cedingName">
								</div>
							</div>
							<div class="col-sm-6">
								<div class="input-group">
									<label class="form-control-sm col-sm-3">Risk</label>
									<input type="text" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.riskName">
									<div class="col-sm-1"></div>
								</div>
							</div>
						</div>
						<div class="form-row">
							<div class="col-sm-6">
								<div class="input-group">
									<label class="form-control-sm col-sm-3">Insured</label>
									<input type="text" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.insuredDesc">
								</div>
							</div>
							<div class="col-sm-6"></div>
						</div>
					</div>
				</fieldset>

				<fieldset class="scheduler-border">
					<legend class="scheduler-border">Period of Insurance</legend>
					<div class="custom-row-inline-inset">
						<div class="form-row">
							<div class="col-sm-6">
								<div class="input-group">
									<div class="col-sm-4"></div>
									<label class="form-control-sm col-sm-3">Inception Date</label>
									<input type="{{ type }}" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.inceptDate">
									<div class="col-sm-1"></div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="input-group">
									<div class="col-sm-1"></div>
									<label class="form-control-sm col-sm-2">Expiry Date</label>
									<input type="{{ type }}" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.expiryDate">  
									<div class="col-sm-5"></div>
								</div>
							</div>
						</div>
					</div>
				</fieldset>

				<fieldset class="scheduler-border">
					<legend class="scheduler-border">Production Booking</legend>
					<div class="custom-row-inline-inset">
						<div class="form-row">
							<div class="col-sm-6">
								<div class="input-group">
									<div class="col-sm-4"></div>
									<label class="form-control-sm col-sm-3">Issue Date</label>
									<input type="{{ type }}" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.issueDate">
									<div class="col-sm-1"></div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="input-group">
									<label class="form-control-sm col-sm-3">Distribution Date</label>
									<input type="{{ type }}" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.distDate">
									<div class="col-sm-5"></div>
								</div>
							</div>
						</div>
						<div class="form-row">
							<div class="col-sm-6">
								<div class="input-group">
									<div class="col-sm-4"></div>
									<label class="form-control-sm col-sm-3">Effective Date</label>
									<input type="{{ type }}" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.effDate">
									<div class="col-sm-1"></div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="input-group">
									<label class="form-control-sm col-sm-3">Accounting Date</label>
									<input type="{{ type }}" class="form-control form-control-sm col-sm" readonly [(ngModel)]="spoilPolRecord.acctDate">
									<div class="col-sm-5"></div>
								</div>
							</div>
						</div>
					</div>
				</fieldset>


				<fieldset class="scheduler-border fldst">
					<div class="custom-row-inline-inset">
						<div class="form-row">
							<div class="col-sm-6">
								<div class="input-group">
									<div class="col-sm-4"></div>
									<label class="form-control-sm col-sm-3">User</label>
									<input type="text" class="form-control form-control-sm col-sm" [(ngModel)]="spoilPolRecord.user" readonly>
									<div class="col-sm-1"></div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="input-group">
									<label class="form-control-sm col-sm-3">Spoiled Date</label>
									<input type="{{ type }}" class="form-control form-control-sm col-sm" [(ngModel)]="spoilPolRecord.spoiledDate" readonly>
									<div class="col-sm-5"></div>
								</div>
							</div>
						</div>
						<div class="form-row">
							<div class="input-group">
								<div class="col-sm-1" style="margin-right: 49px !important"></div>
								<label class="form-control-sm col-sm-2">Reason for Spoilage</label>
									<input *ngIf="reasonLovEnabled" class="form-control form-control-sm  col-sm-1 dirty" type="text" [(ngModel)]="spoilPolRecord.reason" (change)="onChangeReason()" appRequired>
									<div *ngIf="reasonLovEnabled" class="text-search-ico" style="padding-left: 1px" (click)="showLovSpoil()"><a><i class="fa fa-search"></i></a></div>&nbsp;
									<input  *ngIf="!reasonLovEnabled" class="form-control form-control-sm  col-sm-1" readonly type="text" style="margin-right: 1px !important;     margin-left: -5px !important;">
								<input class="form-control form-control-sm col-sm" type="text" style="margin-left: 2px;" readonly [(ngModel)]="spoilPolRecord.reasonDesc">
								<div class="col-sm-2" style="margin-left: 50px !important;"></div>
							</div>
						</div>
					</div>
				</fieldset>

				<div class="form-row fldst">
					<div class="form-group col-sm">
						<div class="col-md-12 text-center">
							<div class="cust-btn-container">
								<button type="button" class="cust-btn" (click)="onClickCancel()"><a>Cancel</a></button>
								<button type="button" class="cust-btn" *ngIf="postBtnEnabled" (click)="onClickSave()"><a>Post Spoilage</a></button>
								<button type="button" class="cust-btn dsbld" disabled="disabled" *ngIf="!postBtnEnabled">Post Spoilage</button>
							</div>
						</div>
					</div>
				</div>

				<div class="form-row">
                    <div class="form-group col-sm">
                        <div class="col-md-12 text-center">
                            <div class="cust-btn-container" style="margin-top: 10px !important;">
                                <app-modal hidden [btnTitle]="'List Of Values'" id="polLov">
                                    <div header>List Of Values</div>
                                    <div body>
                                       <app-cust-non-datatable [passData]="passData" #p (rowClick)="onRowClick($event)" (searchToDb)="searchQuery($event)"></app-cust-non-datatable>
                                    </div>
                                    <div footer class="text-center w-100">
                                        <div class="col-sm-12 text-center">
                                        <button class="cust-btn" type="button" (click)="onClickCancelLov()"><a>Cancel</a></button>
                                        <button class="cust-btn" type="button" (click)="onClickOkLov()"><a>Ok</a></button>
                                        </div>
                                    </div>
                                </app-modal>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-sm">
                        <div class="col-md-12 text-center">
                            <div class="cust-btn-container" style="margin-top: 10px !important;">
                                <app-modal hidden [btnTitle]="'List Of Values'" id="spoilLov">
                                    <div header>List Of Values</div>
                                    <div body>
                                       <app-cust-non-datatable [passData]="passDataSpoilageReason" #spoil (rowClick)="onRowClickSpoil($event)"></app-cust-non-datatable>
                                    </div>
                                    <div footer class="text-center w-100">
                                        <div class="col-sm-12 text-center">
                                        <button class="cust-btn" type="button" (click)="this.modalService.dismissAll()"><a>Cancel</a></button>
                                        <button class="cust-btn" type="button" (click)="onClickOkSpoil()"><a>Ok</a></button>
                                        </div>
                                    </div>
                                </app-modal>
                            </div>
                        </div>
                    </div>
                </div>
			</ng-template>
		</ngb-tab>
	</ngb-tabset>
</div>

<app-modal class="d-none" id="warnMdl">
    <div header>Warning</div>
    <div body class="container-flex text-center" style="max-width: 300px !important;">
        <fieldset class="scheduler-border" style="padding: 15px !important;min-height: 100px !important"> 
            <p class="form-control-sm" style=" margin: 0px !important; padding: 0px !important;"><b>{{ warnMsg1 }}</b></p>
        </fieldset>
    </div>
    <div footer class="d-flex justify-content-center w-100">                    
        <button class="cust-btn" type="button" (click)="this.modalService.dismissAll()"><a>Ok</a></button>
    </div>
</app-modal>


<app-confirm-save (onYes)="onClickPostSpoilage()"></app-confirm-save>
<app-sucess-dialog [icon]="dialogIcon" [message]="dialogMessage" (onOk)="cancelFlag ? this.cancelBtn.onNo() : null"></app-sucess-dialog>
<app-cancel-button (onYes)="onClickPostSpoilage('cancel')" [url]="'/'" ></app-cancel-button>

<img src="app/resources/images/Loading_icon2.gif" alt="loading.gif" id="loading" class="" style="position: absolute;top:50%;left:50%;-ms-transform: translate(-50%,-50%);transform: translate(-50%,-50%);z-index: 999999" *ngIf="loading">
<div style="position: fixed;width: 100%;height: 100%;z-index: 991;background-color: rgba(255, 255, 255, 0.5);" *ngIf="loading"></div>

<ng-template #confirmLeave>
    <app-confirm-leave></app-confirm-leave>
</ng-template>