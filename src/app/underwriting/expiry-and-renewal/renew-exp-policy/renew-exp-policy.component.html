<div class="cust-tabs-container">
    <h4>Policy / Expiry & Renewal</h4>
    <ngb-tabset>

        <ngb-tab class="ngb-tab" title="Renew Expiring Policy">
            <ng-template ngbTabContent>

            </ng-template>
        </ngb-tab>
    </ngb-tabset>
</div>
<br>
<img src="app/resources/images/Loading_icon2.gif" alt="loading.gif" id="loading" class="" style="position: absolute;top:50%;left:50%;-ms-transform: translate(-50%,-50%);transform: translate(-50%,-50%);z-index: 999999" *ngIf="loading">
<div style="position: fixed;width: 100%;height: 100%;z-index: 991;background-color: rgba(255, 255, 255, 0.5);" *ngIf="loading">
</div>
<div class="row">
    <div class="col-sm-2"></div>
    <div class="col-sm-8">
        <fieldset class="scheduler-border">
            <div class="col-sm-1"></div>
            <div class="col-sm">

                <div class="row" style="margin-right: 0px; margin-bottom: 11px;">
                    <div class="input-group" style="margin-top: -12px !important;">
                        &nbsp;
                    </div>
                    <div class="input-group">

                        <div class="input-group">
                            <label class="form-control-sm col-sm-2">Policy No</label>
                            <input type="text" [ngModel]="polNo[0]" mask="SSS" (ngModelChange)="polNo[0]=$event.toUpperCase()" style="margin-left: 3px;" (change)="search('lineCd',$event)" class="form-control form-control-sm col-sm-2 cap-input" ngbTooltip="Line" appRequired>
                            <input type="text" [(ngModel)]="polNo[1]" mask="9999" (change)="search('year',$event)" class="form-control form-control-sm col-sm-2 cap-input text-right" style="margin-left: 3px;" ngbTooltip="Year" appRequired>
                            <input type="text" [(ngModel)]="polNo[2]" mask="99999" (blur)="polNo[2]=pad($event,5)" (change)="search('seqNo',$event)" class="form-control form-control-sm col-sm-3 cap-input text-right" style="margin-left: 3px;" ngbTooltip="Sequence No" appRequired>
                            <input type="text" [(ngModel)]="polNo[3]" mask="999" (blur)="polNo[3]=pad($event,3)" (change)="search('cedingId',$event)" class="form-control form-control-sm col-sm-1 cap-input text-right" style="margin-left: 3px;" ngbTooltip="Company No" appRequired>
                            <input type="text" [(ngModel)]="polNo[4]" mask="9999" (blur)="polNo[4]=pad($event,4)" (change)="search('coSeriesNo',$event)" class="form-control form-control-sm col-sm-2 cap-input text-right" style="margin-left: 3px;" ngbTooltip="Co Series No" appRequired>
                             <input type="text" [(ngModel)]="polNo[5]" mask="999" (blur)="polNo[5]=pad($event,3)" (change)="search('altNo',$event)" class="form-control form-control-sm col-sm-2 cap-input text-right" style="margin-left: 3px;" ngbTooltip="Alt No" appRequired>
                            <span>&nbsp;</span>
                            <div class="text-search-ico"><a><i (click)="showLOV()" class="fa fa-search"></i></a></div>
                        </div>
                        <!-- <div class="input-group ig-row" style="margin-top: -6px !important; margin-bottom: 0px !important;">
                            <label class="form-control-sm col-sm-2">Expiry Date</label>
                            <div class="col-sm dp-cont" style="margin-left: 0px !important;">
                                <datepicker [disabled]="true" [type]="'date'" [showIcon]="true" [value]="expiryDate?.split('T')[0]" (valueChange)="expiryDate=$event+'T'+expiryDate.split('T')[1];"></datepicker>
                            </div>
                        </div>    -->                 
                        <div class="input-group ig-row" style="margin-top: -6px !important;">
                            <label class="form-control-sm col-sm-2">Ceding Company</label>
                            <input type="text" class="form-control form-control-sm" [ngModel]="cedingName" readonly tabindex="-1">
                        </div>
                        <div class="input-group ig-row">
                            <label class="form-control-sm col-sm-2">Insured</label>
                            <input type="text" class="form-control form-control-sm" [ngModel]="insuredDesc" readonly tabindex="-1">
                        </div>
                        <div class="input-group ig-row">
                            <label class="form-control-sm col-sm-2">Risk</label>
                            <input type="text" class="form-control form-control-sm" [ngModel]="riskName" readonly tabindex="-1">
                        </div>
                        <div class="input-group ig-row ">
                            <label class="form-control-sm col-sm-2">Inception Date</label>
                        
                            <div class="col-sm-2 dp-cont">
                                <datepicker [type]="'date'" [required]="true" [showIcon]="true" [value]="inceptionDate" (valueChange)="inceptionDate=$event; updateExpiryDate();"></datepicker>
                            </div>
                            <div class="col-sm-2 dp-cont">
                                <datepicker [type]="'time'" [required]="true" [value]="inceptionTime" (valueChange)="inceptionTime=$event;" [textAlign]="'center'"></datepicker>  
                            </div>
                            <label class="form-control-sm col-sm" >Expiry Date</label>
                            
                            <div class="col-sm-2 dp-cont">
                                <datepicker [type]="'date'" [required]="true" [showIcon]="true" [value]="expiryDate" (valueChange)="expiryDate=$event" [minDate]="inceptionDate"></datepicker>
                            </div>
                            <div class="col-sm-2 dp-cont">
                                <datepicker [type]="'time'" [required]="true" [value]="expiryTime" (valueChange)="expiryTime=$event;" [textAlign]="'center'"></datepicker>  
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="col-sm-2"></div>
</div>
<div class="form-row">
    <div class="form-group col-sm">
        <div class="col-md-12 text-center">
            <div class="cust-btn-container" style="margin-top:10px">
                <button type="button" class="cust-btn" [routerLink]="['']"><a>Cancel</a></button>
                <button type="button" (click)="renewPolicy()" class="cust-btn" [disabled]="selected == null || cedingName == '' || insuredDesc == '' || riskName == '' || !doneCheck"><a>Renew</a></button>
            </div>
        </div>
    </div>
</div>

<app-modal hidden [btnTitle]="'List Of Values'" id="altPolLovMdl">
    <div header>List Of Values</div>
    <div body>
       <!-- <app-cust-non-datatable [passData]="passDataLOV" #altPolLov (rowClick)="onRowClick($event);" (searchToDb)="searchQuery($event)"></app-cust-non-datatable> TRBT#PROD_GRADE -->
       <app-loading-table [passData]="passDataLOV" #altPolLov (rowClick)="onRowClick($event);" (searchToDb)="searchQuery($event)"></app-loading-table>
    </div>
    <div footer class="text-center w-100">
        <div class="col-sm-12 text-center">
        <button class="cust-btn" type="button" (click)="modalService.dismissAll();"><a>Cancel</a></button>
        <button class="cust-btn" type="button" (click)="modalService.dismissAll(); setDetails('mdlOk');"><a>Ok</a></button>        
        </div>
    </div>
</app-modal>

<app-modal class="d-none" id="altWarningModal">
    <div header>{{ warningMsg == 3 ? 'Information Message' : 'Warning Message' }}</div>
    <div body style="min-width: 420px !important;">
        <fieldset class="scheduler-border" style="padding: 17px 20px 12px 20px !important;">
            <div class="custom-row-inline-inset" style="text-align: center">                
                <p *ngIf="warningMsg == 0">The Policy No. cannot be altered. Creation of alteration<br />
                connected to this record is ongoing.</p>
                <p *ngIf="warningMsg == 1">The Policy No. cannot be altered. Policy No. has co-insurance/s.<br />
                Creation of <strong>alteration</strong> connected to one of the policies under this<br />
                co-insurance is ongoing.</p>
                <p *ngIf="warningMsg == 2">The Policy No. cannot be altered. Policy No. has co-insurance/s.<br />
                Creation of <strong>policy</strong> connected to one of the policies under this<br />
                co-insurance is ongoing.</p>
                <p *ngIf="warningMsg == 3">The policy has pending claim/s.</p>
            </div>
        </fieldset>
    </div>
    <div footer class="w-100 text-center">
        <button *ngIf="warningMsg != 3" class="cust-btn" type="button" (click)="modalService.dismissAll(); clearFields();"><a>Ok</a></button>
        <button *ngIf="warningMsg == 3" class="cust-btn" type="button" (click)="modalService.dismissAll();"><a>Ok</a></button>
    </div>
</app-modal>

<app-modal class="d-none" id="convSuccessModal">
    <div header>Success Message</div>
    <div body style="min-width: 420px !important;">
        <fieldset class="scheduler-border" style="padding-top: 5px !important;">
            <div class="custom-row-inline-inset" style="text-align: center">
                <p class="mg-b">Expiring Policy : <strong>{{ renewedPolicy.policyNo }}</strong></p>
                <p>was successfully renewed to Policy No.</p>
                <p><strong>{{ renewedPolicy.newPolicyNo }}</strong></p>
            </div>
        </fieldset>
    </div>
    <div footer class="w-100 text-center">
        <button class="cust-btn" type="button" (click)="modalService.dismissAll(); toPolGenInfo();"><a>Ok</a></button>
    </div>
</app-modal>